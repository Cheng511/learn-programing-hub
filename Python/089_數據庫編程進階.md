[ä¸Šä¸€ç« ï¼šæ•¸æ“šåº«ç·¨ç¨‹åŸºç¤](088_æ•¸æ“šåº«ç·¨ç¨‹åŸºç¤.md) | [ä¸‹ä¸€ç« ï¼šWebé–‹ç™¼åŸºç¤](090_Webé–‹ç™¼åŸºç¤.md)

# Python æ•¸æ“šåº«ç·¨ç¨‹é€²éš ğŸ’¾

## MySQLæ•¸æ“šåº«

### 1. MySQLé€£æ¥å™¨

```python
import mysql.connector
import time
from typing import List, Dict, Any, Optional
import sys
import os

class MySQLConnector:
    def __init__(self, host: str, user: str, password: str, database: str):
        """åˆå§‹åŒ–MySQLé€£æ¥å™¨"""
        self.host = host
        self.user = user
        self.password = password
        self.database = database
        self.conn: Optional[mysql.connector.MySQLConnection] = None
        self.cursor: Optional[mysql.connector.MySQLCursor] = None
    
    def connect(self):
        """é€£æ¥åˆ°æ•¸æ“šåº«"""
        try:
            # å»ºç«‹é€£æ¥
            self.conn = mysql.connector.connect(
                host=self.host,
                user=self.user,
                password=self.password,
                database=self.database
            )
            self.cursor = self.conn.cursor()
            print(f"Connected to MySQL database: {self.database}")
            
        except Exception as e:
            print(f"Error connecting to database: {e}")
            self.close()
    
    def close(self):
        """é—œé–‰æ•¸æ“šåº«é€£æ¥"""
        if self.cursor:
            self.cursor.close()
        if self.conn:
            self.conn.close()
        print("Database connection closed")
    
    def execute_query(self, query: str, params: tuple = ()):
        """åŸ·è¡ŒSQLæŸ¥è©¢"""
        try:
            # åŸ·è¡ŒæŸ¥è©¢
            self.cursor.execute(query, params)
            self.conn.commit()
            
            # ç²å–çµæœ
            return self.cursor.fetchall()
            
        except Exception as e:
            print(f"Error executing query: {e}")
            self.conn.rollback()
            return []
    
    def create_table(self, table_name: str, columns: List[str]):
        """å‰µå»ºæ•¸æ“šè¡¨"""
        try:
            # æ§‹å»ºCREATE TABLEèªå¥
            query = f"CREATE TABLE IF NOT EXISTS {table_name} ({', '.join(columns)})"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query)
            print(f"Table {table_name} created successfully")
            
        except Exception as e:
            print(f"Error creating table: {e}")
    
    def insert_data(self, table_name: str, data: Dict[str, Any]):
        """æ’å…¥æ•¸æ“š"""
        try:
            # æ§‹å»ºINSERTèªå¥
            columns = ', '.join(data.keys())
            placeholders = ', '.join(['%s' for _ in data])
            query = f"INSERT INTO {table_name} ({columns}) VALUES ({placeholders})"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query, tuple(data.values()))
            print(f"Data inserted into {table_name}")
            
        except Exception as e:
            print(f"Error inserting data: {e}")
    
    def select_data(self, table_name: str, columns: List[str] = None, where: str = None):
        """æŸ¥è©¢æ•¸æ“š"""
        try:
            # æ§‹å»ºSELECTèªå¥
            cols = '*' if not columns else ', '.join(columns)
            query = f"SELECT {cols} FROM {table_name}"
            
            if where:
                query += f" WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            return self.execute_query(query)
            
        except Exception as e:
            print(f"Error selecting data: {e}")
            return []
    
    def update_data(self, table_name: str, data: Dict[str, Any], where: str):
        """æ›´æ–°æ•¸æ“š"""
        try:
            # æ§‹å»ºUPDATEèªå¥
            set_clause = ', '.join([f"{k} = %s" for k in data.keys()])
            query = f"UPDATE {table_name} SET {set_clause} WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query, tuple(data.values()))
            print(f"Data updated in {table_name}")
            
        except Exception as e:
            print(f"Error updating data: {e}")
    
    def delete_data(self, table_name: str, where: str):
        """åˆªé™¤æ•¸æ“š"""
        try:
            # æ§‹å»ºDELETEèªå¥
            query = f"DELETE FROM {table_name} WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query)
            print(f"Data deleted from {table_name}")
            
        except Exception as e:
            print(f"Error deleting data: {e}")

# ä½¿ç”¨ç¤ºä¾‹
def main():
    # å‰µå»ºé€£æ¥å™¨
    connector = MySQLConnector(
        host='localhost',
        user='root',
        password='password',
        database='test_db'
    )
    
    try:
        # é€£æ¥åˆ°æ•¸æ“šåº«
        connector.connect()
        
        # å‰µå»ºç”¨æˆ¶è¡¨
        connector.create_table('users', [
            'id INT AUTO_INCREMENT PRIMARY KEY',
            'name VARCHAR(100) NOT NULL',
            'email VARCHAR(100) UNIQUE',
            'age INT'
        ])
        
        # æ’å…¥æ•¸æ“š
        connector.insert_data('users', {
            'name': 'John Doe',
            'email': 'john@example.com',
            'age': 30
        })
        
        # æŸ¥è©¢æ•¸æ“š
        results = connector.select_data('users')
        print("Users:", results)
        
        # æ›´æ–°æ•¸æ“š
        connector.update_data('users', {'age': 31}, 'name = "John Doe"')
        
        # æŸ¥è©¢æ›´æ–°å¾Œçš„æ•¸æ“š
        results = connector.select_data('users')
        print("Updated users:", results)
        
        # åˆªé™¤æ•¸æ“š
        connector.delete_data('users', 'name = "John Doe"')
        
        # æŸ¥è©¢åˆªé™¤å¾Œçš„æ•¸æ“š
        results = connector.select_data('users')
        print("Users after deletion:", results)
    
    finally:
        # é—œé–‰é€£æ¥
        connector.close()

if __name__ == '__main__':
    main()
```

### 2. æ•¸æ“šåº«é€£æ¥æ± 

```python
import mysql.connector
from mysql.connector import pooling
import time
from typing import List, Dict, Any, Optional
import sys
import os

class DatabasePool:
    def __init__(self, host: str, user: str, password: str, database: str, pool_size: int = 5):
        """åˆå§‹åŒ–æ•¸æ“šåº«é€£æ¥æ± """
        self.db_config = {
            'host': host,
            'user': user,
            'password': password,
            'database': database,
            'pool_name': 'mypool',
            'pool_size': pool_size
        }
        self.pool: Optional[mysql.connector.pooling.MySQLConnectionPool] = None
    
    def create_pool(self):
        """å‰µå»ºé€£æ¥æ± """
        try:
            # å‰µå»ºé€£æ¥æ± 
            self.pool = mysql.connector.pooling.MySQLConnectionPool(**self.db_config)
            print(f"Connection pool created with size: {self.db_config['pool_size']}")
            
        except Exception as e:
            print(f"Error creating connection pool: {e}")
    
    def get_connection(self) -> Optional[mysql.connector.MySQLConnection]:
        """ç²å–æ•¸æ“šåº«é€£æ¥"""
        try:
            if not self.pool:
                self.create_pool()
            
            # å¾é€£æ¥æ± ç²å–é€£æ¥
            conn = self.pool.get_connection()
            print("Connection obtained from pool")
            return conn
            
        except Exception as e:
            print(f"Error getting connection: {e}")
            return None
    
    def execute_query(self, query: str, params: tuple = ()):
        """åŸ·è¡ŒSQLæŸ¥è©¢"""
        conn = None
        cursor = None
        try:
            # ç²å–é€£æ¥
            conn = self.get_connection()
            if not conn:
                return []
            
            # å‰µå»ºæ¸¸æ¨™
            cursor = conn.cursor()
            
            # åŸ·è¡ŒæŸ¥è©¢
            cursor.execute(query, params)
            conn.commit()
            
            # ç²å–çµæœ
            return cursor.fetchall()
            
        except Exception as e:
            print(f"Error executing query: {e}")
            if conn:
                conn.rollback()
            return []
            
        finally:
            # é—œé–‰æ¸¸æ¨™å’Œé€£æ¥
            if cursor:
                cursor.close()
            if conn:
                conn.close()
    
    def create_table(self, table_name: str, columns: List[str]):
        """å‰µå»ºæ•¸æ“šè¡¨"""
        try:
            # æ§‹å»ºCREATE TABLEèªå¥
            query = f"CREATE TABLE IF NOT EXISTS {table_name} ({', '.join(columns)})"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query)
            print(f"Table {table_name} created successfully")
            
        except Exception as e:
            print(f"Error creating table: {e}")
    
    def insert_data(self, table_name: str, data: Dict[str, Any]):
        """æ’å…¥æ•¸æ“š"""
        try:
            # æ§‹å»ºINSERTèªå¥
            columns = ', '.join(data.keys())
            placeholders = ', '.join(['%s' for _ in data])
            query = f"INSERT INTO {table_name} ({columns}) VALUES ({placeholders})"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query, tuple(data.values()))
            print(f"Data inserted into {table_name}")
            
        except Exception as e:
            print(f"Error inserting data: {e}")
    
    def select_data(self, table_name: str, columns: List[str] = None, where: str = None):
        """æŸ¥è©¢æ•¸æ“š"""
        try:
            # æ§‹å»ºSELECTèªå¥
            cols = '*' if not columns else ', '.join(columns)
            query = f"SELECT {cols} FROM {table_name}"
            
            if where:
                query += f" WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            return self.execute_query(query)
            
        except Exception as e:
            print(f"Error selecting data: {e}")
            return []
    
    def update_data(self, table_name: str, data: Dict[str, Any], where: str):
        """æ›´æ–°æ•¸æ“š"""
        try:
            # æ§‹å»ºUPDATEèªå¥
            set_clause = ', '.join([f"{k} = %s" for k in data.keys()])
            query = f"UPDATE {table_name} SET {set_clause} WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query, tuple(data.values()))
            print(f"Data updated in {table_name}")
            
        except Exception as e:
            print(f"Error updating data: {e}")
    
    def delete_data(self, table_name: str, where: str):
        """åˆªé™¤æ•¸æ“š"""
        try:
            # æ§‹å»ºDELETEèªå¥
            query = f"DELETE FROM {table_name} WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query)
            print(f"Data deleted from {table_name}")
            
        except Exception as e:
            print(f"Error deleting data: {e}")

# ä½¿ç”¨ç¤ºä¾‹
def main():
    # å‰µå»ºé€£æ¥æ± 
    pool = DatabasePool(
        host='localhost',
        user='root',
        password='password',
        database='test_db',
        pool_size=5
    )
    
    try:
        # å‰µå»ºç”¨æˆ¶è¡¨
        pool.create_table('users', [
            'id INT AUTO_INCREMENT PRIMARY KEY',
            'name VARCHAR(100) NOT NULL',
            'email VARCHAR(100) UNIQUE',
            'age INT'
        ])
        
        # æ’å…¥æ•¸æ“š
        pool.insert_data('users', {
            'name': 'John Doe',
            'email': 'john@example.com',
            'age': 30
        })
        
        # æŸ¥è©¢æ•¸æ“š
        results = pool.select_data('users')
        print("Users:", results)
        
        # æ›´æ–°æ•¸æ“š
        pool.update_data('users', {'age': 31}, 'name = "John Doe"')
        
        # æŸ¥è©¢æ›´æ–°å¾Œçš„æ•¸æ“š
        results = pool.select_data('users')
        print("Updated users:", results)
        
        # åˆªé™¤æ•¸æ“š
        pool.delete_data('users', 'name = "John Doe"')
        
        # æŸ¥è©¢åˆªé™¤å¾Œçš„æ•¸æ“š
        results = pool.select_data('users')
        print("Users after deletion:", results)
    
    except Exception as e:
        print(f"Error in main: {e}")

if __name__ == '__main__':
    main()
```

## ç·´ç¿’é¡Œ

1. **MySQLé€£æ¥å™¨**
   é–‹ç™¼ä¸€å€‹MySQLé€£æ¥å™¨ï¼š
   - æ”¯æŒæ•¸æ“šåº«é€£æ¥
   - è™•ç†SQLæŸ¥è©¢
   - å„ªåŒ–è³‡æºä½¿ç”¨
   - æä¾›éŒ¯èª¤è™•ç†

2. **æ•¸æ“šåº«é€£æ¥æ± **
   å‰µå»ºä¸€å€‹æ•¸æ“šåº«é€£æ¥æ± ï¼š
   - ç®¡ç†é€£æ¥è³‡æº
   - å„ªåŒ–é€£æ¥æ•ˆç‡
   - è™•ç†é€£æ¥ç•°å¸¸
   - æä¾›é€£æ¥ç›£æ§

3. **æ•¸æ“šåº«æ‡‰ç”¨**
   å¯¦ç¾ä¸€å€‹æ•¸æ“šåº«æ‡‰ç”¨ï¼š
   - è¨­è¨ˆæ•¸æ“šæ¨¡å‹
   - å¯¦ç¾CRUDæ“ä½œ
   - å„ªåŒ–æ€§èƒ½
   - è™•ç†è¤‡é›œæŸ¥è©¢

## å°æé†’ ğŸ’¡

1. æ•¸æ“šåº«è¨­è¨ˆ
   - é¸æ“‡åˆé©æ¨¡å‹
   - è¨­è¨ˆè¡¨çµæ§‹
   - å„ªåŒ–ç´¢å¼•
   - è€ƒæ…®æ“´å±•æ€§

2. æ•¸æ“šæ“ä½œ
   - ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢
   - è™•ç†äº‹å‹™
   - å„ªåŒ–æŸ¥è©¢
   - è™•ç†ç•°å¸¸

3. æ€§èƒ½å„ªåŒ–
   - æ¸›å°‘æŸ¥è©¢æ¬¡æ•¸
   - å„ªåŒ–ç´¢å¼•
   - ä½¿ç”¨é€£æ¥æ± 
   - ç›£æ§æ€§èƒ½

4. èª¿è©¦æŠ€å·§
   - ä½¿ç”¨SQLå·¥å…·
   - åˆ†ææŸ¥è©¢è¨ˆåŠƒ
   - å„ªåŒ–é—œéµè·¯å¾‘
   - ç›£æ§æ•¸æ“šåº«ç‹€æ…‹

[ä¸Šä¸€ç« ï¼šæ•¸æ“šåº«ç·¨ç¨‹åŸºç¤](088_æ•¸æ“šåº«ç·¨ç¨‹åŸºç¤.md) | [ä¸‹ä¸€ç« ï¼šWebé–‹ç™¼åŸºç¤](090_Webé–‹ç™¼åŸºç¤.md) 