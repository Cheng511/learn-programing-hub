[ä¸Šä¸€ç« ï¼šé¡åˆ¥å¤šå‹](030_é¡åˆ¥å¤šå‹.md) | [ä¸‹ä¸€ç« ï¼šç•°å¸¸è™•ç†é€²éš](032_ç•°å¸¸è™•ç†é€²éš.md)

# Python ç•°å¸¸è™•ç†åŸºç¤ ğŸ›¡ï¸

## ä»€éº¼æ˜¯ç•°å¸¸ï¼Ÿ

ç•°å¸¸æ˜¯ç¨‹å¼åŸ·è¡ŒæœŸé–“ç™¼ç”Ÿçš„éŒ¯èª¤ã€‚Python ä½¿ç”¨ç•°å¸¸ç‰©ä»¶ä¾†è¡¨ç¤ºé€™äº›éŒ¯èª¤ï¼Œä¸¦æä¾›äº†è™•ç†é€™äº›éŒ¯èª¤çš„æ©Ÿåˆ¶ã€‚

## å¸¸è¦‹çš„ç•°å¸¸é¡å‹

### 1. åŸºæœ¬ç•°å¸¸

```python
# TypeErrorï¼šé¡å‹éŒ¯èª¤
result = "123" + 456  # å­—ç¬¦ä¸²ä¸èƒ½å’Œæ•¸å­—ç›¸åŠ 

# NameErrorï¼šä½¿ç”¨æœªå®šç¾©çš„è®Šæ•¸
print(undefined_variable)

# ZeroDivisionErrorï¼šé™¤ä»¥é›¶
result = 10 / 0

# IndexErrorï¼šç´¢å¼•è¶…å‡ºç¯„åœ
list_example = [1, 2, 3]
print(list_example[5])

# KeyErrorï¼šä½¿ç”¨ä¸å­˜åœ¨çš„å­—å…¸éµ
dict_example = {"a": 1}
print(dict_example["b"])
```

### 2. èªæ³•å’Œé‚è¼¯éŒ¯èª¤

```python
# SyntaxErrorï¼šèªæ³•éŒ¯èª¤
if True print("Hello")  # ç¼ºå°‘å†’è™Ÿ

# IndentationErrorï¼šç¸®æ’éŒ¯èª¤
def function():
print("Wrong indentation")  # ç¼ºå°‘ç¸®æ’
```

## try-except åŸºæœ¬èªæ³•

### 1. åŸºæœ¬ç•°å¸¸æ•ç²

```python
try:
    number = int(input("è«‹è¼¸å…¥ä¸€å€‹æ•¸å­—ï¼š"))
    result = 100 / number
    print(f"100 é™¤ä»¥ {number} ç­‰æ–¼ {result}")
except ValueError:
    print("è«‹è¼¸å…¥æœ‰æ•ˆçš„æ•¸å­—ï¼")
except ZeroDivisionError:
    print("é™¤æ•¸ä¸èƒ½ç‚ºé›¶ï¼")
```

### 2. æ•ç²å¤šå€‹ç•°å¸¸

```python
def safe_operation():
    try:
        # å¯èƒ½ç”¢ç”Ÿå¤šç¨®ç•°å¸¸çš„æ“ä½œ
        file = open("data.txt")
        number = int(file.readline())
        result = 100 / number
    except (FileNotFoundError, ValueError, ZeroDivisionError) as e:
        print(f"ç™¼ç”ŸéŒ¯èª¤ï¼š{type(e).__name__} - {str(e)}")
    finally:
        if 'file' in locals():
            file.close()
```

## else å’Œ finally å­å¥

### 1. else å­å¥

```python
def process_number():
    try:
        number = int(input("è«‹è¼¸å…¥ä¸€å€‹æ­£æ•¸ï¼š"))
        if number < 0:
            raise ValueError("ä¸èƒ½è¼¸å…¥è² æ•¸")
    except ValueError as e:
        print(f"éŒ¯èª¤ï¼š{e}")
    else:
        # åªæœ‰åœ¨æ²’æœ‰ç•°å¸¸æ™‚åŸ·è¡Œ
        print(f"æ‚¨è¼¸å…¥çš„æ•¸å­—æ˜¯ï¼š{number}")
    finally:
        # ç¸½æ˜¯åŸ·è¡Œ
        print("è™•ç†å®Œæˆ")
```

### 2. finally å­å¥

```python
def read_file_safely(filename):
    file = None
    try:
        file = open(filename, 'r')
        content = file.read()
        return content
    except FileNotFoundError:
        print(f"æ‰¾ä¸åˆ°æª”æ¡ˆï¼š{filename}")
        return None
    finally:
        if file:
            file.close()
            print("æª”æ¡ˆå·²é—œé–‰")
```

## ç•°å¸¸çš„å‚³æ’­

### 1. ç•°å¸¸çš„å‚³é

```python
def level3():
    x = 1 / 0  # å¼•ç™¼ ZeroDivisionError

def level2():
    level3()  # ç•°å¸¸å‘ä¸Šå‚³é

def level1():
    try:
        level2()  # æ•ç²ä¾†è‡ª level2 çš„ç•°å¸¸
    except ZeroDivisionError:
        print("æ•ç²é™¤ä»¥é›¶çš„éŒ¯èª¤")

# èª¿ç”¨å‡½å¼
level1()
```

### 2. raise èªå¥

```python
def validate_age(age):
    if not isinstance(age, int):
        raise TypeError("å¹´é½¡å¿…é ˆæ˜¯æ•´æ•¸")
    if age < 0:
        raise ValueError("å¹´é½¡ä¸èƒ½ç‚ºè² æ•¸")
    if age > 150:
        raise ValueError("å¹´é½¡è¶…å‡ºåˆç†ç¯„åœ")
    return True

# ä½¿ç”¨ validate_age
try:
    validate_age("20")  # å¼•ç™¼ TypeError
except (TypeError, ValueError) as e:
    print(f"é©—è­‰å¤±æ•—ï¼š{e}")
```

## è‡ªå®šç¾©ç•°å¸¸

```python
class CustomError(Exception):
    """è‡ªå®šç¾©ç•°å¸¸é¡åˆ¥"""
    def __init__(self, message):
        self.message = message
        super().__init__(self.message)

def check_password(password):
    if len(password) < 8:
        raise CustomError("å¯†ç¢¼é•·åº¦å¿…é ˆè‡³å°‘ç‚º8å€‹å­—ç¬¦")
    if not any(c.isdigit() for c in password):
        raise CustomError("å¯†ç¢¼å¿…é ˆåŒ…å«è‡³å°‘ä¸€å€‹æ•¸å­—")

# ä½¿ç”¨è‡ªå®šç¾©ç•°å¸¸
try:
    check_password("abc123")
except CustomError as e:
    print(f"å¯†ç¢¼éŒ¯èª¤ï¼š{e}")
```

## æœ€ä½³å¯¦è¸

### 1. å…·é«”ç•°å¸¸è™•ç†

```python
def process_data(data):
    try:
        # ä¸å¥½çš„åšæ³•
        # except Exception as e:
        #     print(f"ç™¼ç”ŸéŒ¯èª¤ï¼š{e}")
        
        # å¥½çš„åšæ³•
        result = process_step1(data)
        result = process_step2(result)
        return process_step3(result)
    except ValueError as e:
        print(f"æ•¸å€¼éŒ¯èª¤ï¼š{e}")
    except TypeError as e:
        print(f"é¡å‹éŒ¯èª¤ï¼š{e}")
    except KeyError as e:
        print(f"éµéŒ¯èª¤ï¼š{e}")
```

### 2. æ¸…ç†è³‡æº

```python
def process_file_with_context():
    # æ¨è–¦ä½¿ç”¨ with èªå¥
    with open("data.txt", "r") as file:
        content = file.read()
        process_content(content)
    # æª”æ¡ˆæœƒè‡ªå‹•é—œé–‰

# ä¸æ¨è–¦çš„æ–¹å¼
def process_file_without_context():
    file = open("data.txt", "r")
    try:
        content = file.read()
        process_content(content)
    finally:
        file.close()
```

## ç·´ç¿’é¡Œ

1. **æª”æ¡ˆè™•ç†ç•°å¸¸**
   å¯¦ç¾ä¸€å€‹å®‰å…¨çš„æª”æ¡ˆè®€å–å‡½å¼ï¼š
   - è™•ç†æª”æ¡ˆä¸å­˜åœ¨çš„æƒ…æ³
   - è™•ç†æ¬Šé™éŒ¯èª¤
   - ç¢ºä¿æ­£ç¢ºé—œé–‰æª”æ¡ˆ

2. **æ•¸æ“šé©—è­‰ç³»çµ±**
   å‰µå»ºä¸€å€‹æ•¸æ“šé©—è­‰ç³»çµ±ï¼š
   - æª¢æŸ¥æ•¸æ“šé¡å‹
   - é©—è­‰æ•¸å€¼ç¯„åœ
   - ä½¿ç”¨è‡ªå®šç¾©ç•°å¸¸

3. **è³‡æºç®¡ç†å™¨**
   å¯¦ç¾ä¸€å€‹è³‡æºç®¡ç†é¡ï¼š
   - å®‰å…¨åœ°ç²å–å’Œé‡‹æ”¾è³‡æº
   - è™•ç†ç•°å¸¸æƒ…æ³
   - ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨

## å°æé†’ ğŸ’¡

1. åªæ•ç²é æœŸçš„ç•°å¸¸
2. é¿å…æ•ç²æ‰€æœ‰ç•°å¸¸
3. é©ç•¶ä½¿ç”¨ finally å­å¥
4. ä½¿ç”¨å…·é«”çš„ç•°å¸¸é¡å‹
5. ä¿æŒç•°å¸¸è™•ç†çš„ç°¡æ½”
6. æ­£ç¢ºæ¸…ç†è³‡æº

[ä¸Šä¸€ç« ï¼šé¡åˆ¥å¤šå‹](030_é¡åˆ¥å¤šå‹.md) | [ä¸‹ä¸€ç« ï¼šç•°å¸¸è™•ç†é€²éš](032_ç•°å¸¸è™•ç†é€²éš.md) 