[ä¸Šä¸€ç« ï¼šç¶²çµ¡ç·¨ç¨‹é€²éš](109_ç¶²çµ¡ç·¨ç¨‹é€²éš.md) | [ä¸‹ä¸€ç« ï¼šæ•¸æ“šåº«é€²éš](111_æ•¸æ“šåº«é€²éš.md)

# Python æ•¸æ“šåº«åŸºç¤ ğŸ’¾

## æ•¸æ“šåº«åŸºç¤

### 1. SQLiteæ•¸æ“šåº«

```python
import sqlite3
import sys
import os
from typing import Tuple, List, Optional, Dict
import time
import json

class SQLiteDatabase:
    def __init__(self, db_file: str = "database.db"):
        """åˆå§‹åŒ–SQLiteæ•¸æ“šåº«"""
        try:
            # é€£æ¥æ•¸æ“šåº«
            self.conn = sqlite3.connect(db_file)
            self.cursor = self.conn.cursor()
            
            print(f"SQLite database initialized: {db_file}")
            
        except Exception as e:
            print(f"Error initializing SQLite database: {e}")
    
    def create_table(self, table_name: str, columns: List[Tuple[str, str]]):
        """å‰µå»ºè¡¨"""
        try:
            # æ§‹å»ºåˆ—å®šç¾©
            column_defs = ", ".join([f"{col[0]} {col[1]}" for col in columns])
            
            # å‰µå»ºè¡¨
            self.cursor.execute(f"CREATE TABLE IF NOT EXISTS {table_name} ({column_defs})")
            self.conn.commit()
            
            print(f"Table created: {table_name}")
            
        except Exception as e:
            print(f"Error creating table: {e}")
    
    def insert_data(self, table_name: str, data: Dict):
        """æ’å…¥æ•¸æ“š"""
        try:
            # æ§‹å»ºåˆ—åå’Œå€¼
            columns = ", ".join(data.keys())
            values = ", ".join(["?" for _ in data])
            
            # æ’å…¥æ•¸æ“š
            self.cursor.execute(f"INSERT INTO {table_name} ({columns}) VALUES ({values})", 
                              list(data.values()))
            self.conn.commit()
            
            print(f"Data inserted into {table_name}")
            
        except Exception as e:
            print(f"Error inserting data: {e}")
    
    def query_data(self, table_name: str, conditions: Optional[Dict] = None) -> List[Dict]:
        """æŸ¥è©¢æ•¸æ“š"""
        try:
            # æ§‹å»ºæŸ¥è©¢èªå¥
            query = f"SELECT * FROM {table_name}"
            
            if conditions:
                where_clause = " AND ".join([f"{k} = ?" for k in conditions.keys()])
                query += f" WHERE {where_clause}"
                self.cursor.execute(query, list(conditions.values()))
            else:
                self.cursor.execute(query)
            
            # ç²å–åˆ—å
            columns = [description[0] for description in self.cursor.description]
            
            # ç²å–çµæœ
            results = []
            for row in self.cursor.fetchall():
                results.append(dict(zip(columns, row)))
            
            return results
            
        except Exception as e:
            print(f"Error querying data: {e}")
            return []
    
    def update_data(self, table_name: str, data: Dict, conditions: Dict):
        """æ›´æ–°æ•¸æ“š"""
        try:
            # æ§‹å»ºSETå­å¥
            set_clause = ", ".join([f"{k} = ?" for k in data.keys()])
            
            # æ§‹å»ºWHEREå­å¥
            where_clause = " AND ".join([f"{k} = ?" for k in conditions.keys()])
            
            # æ›´æ–°æ•¸æ“š
            self.cursor.execute(f"UPDATE {table_name} SET {set_clause} WHERE {where_clause}",
                              list(data.values()) + list(conditions.values()))
            self.conn.commit()
            
            print(f"Data updated in {table_name}")
            
        except Exception as e:
            print(f"Error updating data: {e}")
    
    def delete_data(self, table_name: str, conditions: Dict):
        """åˆªé™¤æ•¸æ“š"""
        try:
            # æ§‹å»ºWHEREå­å¥
            where_clause = " AND ".join([f"{k} = ?" for k in conditions.keys()])
            
            # åˆªé™¤æ•¸æ“š
            self.cursor.execute(f"DELETE FROM {table_name} WHERE {where_clause}",
                              list(conditions.values()))
            self.conn.commit()
            
            print(f"Data deleted from {table_name}")
            
        except Exception as e:
            print(f"Error deleting data: {e}")
    
    def close(self):
        """é—œé–‰æ•¸æ“šåº«é€£æ¥"""
        try:
            self.conn.close()
            print("Database connection closed")
            
        except Exception as e:
            print(f"Error closing database connection: {e}")

# ä½¿ç”¨ç¤ºä¾‹
def main():
    # å‰µå»ºæ•¸æ“šåº«
    db = SQLiteDatabase()
    
    try:
        # å‰µå»ºè¡¨
        columns = [
            ("id", "INTEGER PRIMARY KEY"),
            ("name", "TEXT"),
            ("age", "INTEGER"),
            ("email", "TEXT")
        ]
        db.create_table("users", columns)
        
        # æ’å…¥æ•¸æ“š
        user_data = {
            "id": 1,
            "name": "John Doe",
            "age": 30,
            "email": "john@example.com"
        }
        db.insert_data("users", user_data)
        
        # æŸ¥è©¢æ•¸æ“š
        results = db.query_data("users")
        print(f"Query results: {results}")
        
        # æ›´æ–°æ•¸æ“š
        update_data = {"age": 31}
        conditions = {"id": 1}
        db.update_data("users", update_data, conditions)
        
        # æŸ¥è©¢æ›´æ–°å¾Œçš„æ•¸æ“š
        results = db.query_data("users")
        print(f"Updated results: {results}")
        
        # åˆªé™¤æ•¸æ“š
        db.delete_data("users", conditions)
        
        # æŸ¥è©¢åˆªé™¤å¾Œçš„æ•¸æ“š
        results = db.query_data("users")
        print(f"Final results: {results}")
    
    except Exception as e:
        print(f"Error in main: {e}")
    finally:
        # é—œé–‰æ•¸æ“šåº«é€£æ¥
        db.close()

if __name__ == '__main__':
    main()
```

### 2. MySQLæ•¸æ“šåº«

```python
import mysql.connector
import sys
import os
from typing import Tuple, List, Optional, Dict
import time
import json

class MySQLDatabase:
    def __init__(self, host: str = "localhost", user: str = "root",
                 password: str = "", database: str = "test"):
        """åˆå§‹åŒ–MySQLæ•¸æ“šåº«"""
        try:
            # é€£æ¥æ•¸æ“šåº«
            self.conn = mysql.connector.connect(
                host=host,
                user=user,
                password=password,
                database=database
            )
            self.cursor = self.conn.cursor(dictionary=True)
            
            print(f"MySQL database initialized: {database}")
            
        except Exception as e:
            print(f"Error initializing MySQL database: {e}")
    
    def create_table(self, table_name: str, columns: List[Tuple[str, str]]):
        """å‰µå»ºè¡¨"""
        try:
            # æ§‹å»ºåˆ—å®šç¾©
            column_defs = ", ".join([f"{col[0]} {col[1]}" for col in columns])
            
            # å‰µå»ºè¡¨
            self.cursor.execute(f"CREATE TABLE IF NOT EXISTS {table_name} ({column_defs})")
            self.conn.commit()
            
            print(f"Table created: {table_name}")
            
        except Exception as e:
            print(f"Error creating table: {e}")
    
    def insert_data(self, table_name: str, data: Dict):
        """æ’å…¥æ•¸æ“š"""
        try:
            # æ§‹å»ºåˆ—åå’Œå€¼
            columns = ", ".join(data.keys())
            values = ", ".join(["%s" for _ in data])
            
            # æ’å…¥æ•¸æ“š
            self.cursor.execute(f"INSERT INTO {table_name} ({columns}) VALUES ({values})",
                              list(data.values()))
            self.conn.commit()
            
            print(f"Data inserted into {table_name}")
            
        except Exception as e:
            print(f"Error inserting data: {e}")
    
    def query_data(self, table_name: str, conditions: Optional[Dict] = None) -> List[Dict]:
        """æŸ¥è©¢æ•¸æ“š"""
        try:
            # æ§‹å»ºæŸ¥è©¢èªå¥
            query = f"SELECT * FROM {table_name}"
            
            if conditions:
                where_clause = " AND ".join([f"{k} = %s" for k in conditions.keys()])
                query += f" WHERE {where_clause}"
                self.cursor.execute(query, list(conditions.values()))
            else:
                self.cursor.execute(query)
            
            # ç²å–çµæœ
            return self.cursor.fetchall()
            
        except Exception as e:
            print(f"Error querying data: {e}")
            return []
    
    def update_data(self, table_name: str, data: Dict, conditions: Dict):
        """æ›´æ–°æ•¸æ“š"""
        try:
            # æ§‹å»ºSETå­å¥
            set_clause = ", ".join([f"{k} = %s" for k in data.keys()])
            
            # æ§‹å»ºWHEREå­å¥
            where_clause = " AND ".join([f"{k} = %s" for k in conditions.keys()])
            
            # æ›´æ–°æ•¸æ“š
            self.cursor.execute(f"UPDATE {table_name} SET {set_clause} WHERE {where_clause}",
                              list(data.values()) + list(conditions.values()))
            self.conn.commit()
            
            print(f"Data updated in {table_name}")
            
        except Exception as e:
            print(f"Error updating data: {e}")
    
    def delete_data(self, table_name: str, conditions: Dict):
        """åˆªé™¤æ•¸æ“š"""
        try:
            # æ§‹å»ºWHEREå­å¥
            where_clause = " AND ".join([f"{k} = %s" for k in conditions.keys()])
            
            # åˆªé™¤æ•¸æ“š
            self.cursor.execute(f"DELETE FROM {table_name} WHERE {where_clause}",
                              list(conditions.values()))
            self.conn.commit()
            
            print(f"Data deleted from {table_name}")
            
        except Exception as e:
            print(f"Error deleting data: {e}")
    
    def close(self):
        """é—œé–‰æ•¸æ“šåº«é€£æ¥"""
        try:
            self.conn.close()
            print("Database connection closed")
            
        except Exception as e:
            print(f"Error closing database connection: {e}")

# ä½¿ç”¨ç¤ºä¾‹
def main():
    # å‰µå»ºæ•¸æ“šåº«
    db = MySQLDatabase()
    
    try:
        # å‰µå»ºè¡¨
        columns = [
            ("id", "INT AUTO_INCREMENT PRIMARY KEY"),
            ("name", "VARCHAR(255)"),
            ("age", "INT"),
            ("email", "VARCHAR(255)")
        ]
        db.create_table("users", columns)
        
        # æ’å…¥æ•¸æ“š
        user_data = {
            "name": "John Doe",
            "age": 30,
            "email": "john@example.com"
        }
        db.insert_data("users", user_data)
        
        # æŸ¥è©¢æ•¸æ“š
        results = db.query_data("users")
        print(f"Query results: {results}")
        
        # æ›´æ–°æ•¸æ“š
        update_data = {"age": 31}
        conditions = {"id": 1}
        db.update_data("users", update_data, conditions)
        
        # æŸ¥è©¢æ›´æ–°å¾Œçš„æ•¸æ“š
        results = db.query_data("users")
        print(f"Updated results: {results}")
        
        # åˆªé™¤æ•¸æ“š
        db.delete_data("users", conditions)
        
        # æŸ¥è©¢åˆªé™¤å¾Œçš„æ•¸æ“š
        results = db.query_data("users")
        print(f"Final results: {results}")
    
    except Exception as e:
        print(f"Error in main: {e}")
    finally:
        # é—œé–‰æ•¸æ“šåº«é€£æ¥
        db.close()

if __name__ == '__main__':
    main()
```

## ç·´ç¿’é¡Œ

1. **SQLiteæ•¸æ“šåº«**
   é–‹ç™¼SQLiteæ•¸æ“šåº«ï¼š
   - è¡¨æ“ä½œ
   - æ•¸æ“šæ“ä½œ
   - æŸ¥è©¢å„ªåŒ–
   - å„ªåŒ–æ€§èƒ½

2. **MySQLæ•¸æ“šåº«**
   å‰µå»ºMySQLæ•¸æ“šåº«ï¼š
   - è¡¨æ“ä½œ
   - æ•¸æ“šæ“ä½œ
   - æŸ¥è©¢å„ªåŒ–
   - å„ªåŒ–æ€§èƒ½

3. **æ•¸æ“šåº«ç·¨ç¨‹**
   å¯¦ç¾æ•¸æ“šåº«ç·¨ç¨‹ï¼š
   - æ•¸æ“šåº«ç³»çµ±
   - æŸ¥è©¢ç³»çµ±
   - å„ªåŒ–æ€§èƒ½
   - è™•ç†ç•°å¸¸

## å°æé†’ ğŸ’¡

1. SQLiteæ•¸æ“šåº«
   - é¸æ“‡åˆé©æ–¹æ³•
   - å„ªåŒ–åƒæ•¸
   - è™•ç†ç•°å¸¸
   - æä¾›ç›£æ§

2. MySQLæ•¸æ“šåº«
   - é¸æ“‡åˆé©æ–¹æ³•
   - å„ªåŒ–æ€§èƒ½
   - è™•ç†ç•°å¸¸
   - æä¾›çµæœ

3. æ•¸æ“šåº«ç·¨ç¨‹
   - é¸æ“‡åˆé©ç®—æ³•
   - å„ªåŒ–æ€§èƒ½
   - è™•ç†ç•°å¸¸
   - æä¾›ç›£æ§

4. èª¿è©¦æŠ€å·§
   - ä½¿ç”¨é–‹ç™¼å·¥å…·
   - åˆ†ææ€§èƒ½
   - å„ªåŒ–é—œéµè·¯å¾‘
   - ç›£æ§è™•ç†ç‹€æ…‹

[ä¸Šä¸€ç« ï¼šç¶²çµ¡ç·¨ç¨‹é€²éš](109_ç¶²çµ¡ç·¨ç¨‹é€²éš.md) | [ä¸‹ä¸€ç« ï¼šæ•¸æ“šåº«é€²éš](111_æ•¸æ“šåº«é€²éš.md) 