[ä¸Šä¸€ç« ï¼šç¶²çµ¡ç·¨ç¨‹é€²éš](087_ç¶²çµ¡ç·¨ç¨‹é€²éš.md) | [ä¸‹ä¸€ç« ï¼šæ•¸æ“šåº«ç·¨ç¨‹é€²éš](089_æ•¸æ“šåº«ç·¨ç¨‹é€²éš.md)

# Python æ•¸æ“šåº«ç·¨ç¨‹åŸºç¤ ğŸ’¾

## SQLiteæ•¸æ“šåº«

### 1. æ•¸æ“šåº«é€£æ¥å™¨

```python
import sqlite3
import time
from typing import List, Dict, Any, Optional
import sys
import os

class SQLiteConnector:
    def __init__(self, db_path: str):
        """åˆå§‹åŒ–SQLiteé€£æ¥å™¨"""
        self.db_path = db_path
        self.conn: Optional[sqlite3.Connection] = None
        self.cursor: Optional[sqlite3.Cursor] = None
    
    def connect(self):
        """é€£æ¥åˆ°æ•¸æ“šåº«"""
        try:
            # å»ºç«‹é€£æ¥
            self.conn = sqlite3.connect(self.db_path)
            self.cursor = self.conn.cursor()
            print(f"Connected to database: {self.db_path}")
            
        except Exception as e:
            print(f"Error connecting to database: {e}")
            self.close()
    
    def close(self):
        """é—œé–‰æ•¸æ“šåº«é€£æ¥"""
        if self.cursor:
            self.cursor.close()
        if self.conn:
            self.conn.close()
        print("Database connection closed")
    
    def execute_query(self, query: str, params: tuple = ()):
        """åŸ·è¡ŒSQLæŸ¥è©¢"""
        try:
            # åŸ·è¡ŒæŸ¥è©¢
            self.cursor.execute(query, params)
            self.conn.commit()
            
            # ç²å–çµæœ
            return self.cursor.fetchall()
            
        except Exception as e:
            print(f"Error executing query: {e}")
            self.conn.rollback()
            return []
    
    def create_table(self, table_name: str, columns: List[str]):
        """å‰µå»ºæ•¸æ“šè¡¨"""
        try:
            # æ§‹å»ºCREATE TABLEèªå¥
            query = f"CREATE TABLE IF NOT EXISTS {table_name} ({', '.join(columns)})"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query)
            print(f"Table {table_name} created successfully")
            
        except Exception as e:
            print(f"Error creating table: {e}")
    
    def insert_data(self, table_name: str, data: Dict[str, Any]):
        """æ’å…¥æ•¸æ“š"""
        try:
            # æ§‹å»ºINSERTèªå¥
            columns = ', '.join(data.keys())
            placeholders = ', '.join(['?' for _ in data])
            query = f"INSERT INTO {table_name} ({columns}) VALUES ({placeholders})"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query, tuple(data.values()))
            print(f"Data inserted into {table_name}")
            
        except Exception as e:
            print(f"Error inserting data: {e}")
    
    def select_data(self, table_name: str, columns: List[str] = None, where: str = None):
        """æŸ¥è©¢æ•¸æ“š"""
        try:
            # æ§‹å»ºSELECTèªå¥
            cols = '*' if not columns else ', '.join(columns)
            query = f"SELECT {cols} FROM {table_name}"
            
            if where:
                query += f" WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            return self.execute_query(query)
            
        except Exception as e:
            print(f"Error selecting data: {e}")
            return []
    
    def update_data(self, table_name: str, data: Dict[str, Any], where: str):
        """æ›´æ–°æ•¸æ“š"""
        try:
            # æ§‹å»ºUPDATEèªå¥
            set_clause = ', '.join([f"{k} = ?" for k in data.keys()])
            query = f"UPDATE {table_name} SET {set_clause} WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query, tuple(data.values()))
            print(f"Data updated in {table_name}")
            
        except Exception as e:
            print(f"Error updating data: {e}")
    
    def delete_data(self, table_name: str, where: str):
        """åˆªé™¤æ•¸æ“š"""
        try:
            # æ§‹å»ºDELETEèªå¥
            query = f"DELETE FROM {table_name} WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.execute_query(query)
            print(f"Data deleted from {table_name}")
            
        except Exception as e:
            print(f"Error deleting data: {e}")

# ä½¿ç”¨ç¤ºä¾‹
def main():
    # å‰µå»ºé€£æ¥å™¨
    connector = SQLiteConnector('test.db')
    
    try:
        # é€£æ¥åˆ°æ•¸æ“šåº«
        connector.connect()
        
        # å‰µå»ºç”¨æˆ¶è¡¨
        connector.create_table('users', [
            'id INTEGER PRIMARY KEY AUTOINCREMENT',
            'name TEXT NOT NULL',
            'email TEXT UNIQUE',
            'age INTEGER'
        ])
        
        # æ’å…¥æ•¸æ“š
        connector.insert_data('users', {
            'name': 'John Doe',
            'email': 'john@example.com',
            'age': 30
        })
        
        # æŸ¥è©¢æ•¸æ“š
        results = connector.select_data('users')
        print("Users:", results)
        
        # æ›´æ–°æ•¸æ“š
        connector.update_data('users', {'age': 31}, 'name = "John Doe"')
        
        # æŸ¥è©¢æ›´æ–°å¾Œçš„æ•¸æ“š
        results = connector.select_data('users')
        print("Updated users:", results)
        
        # åˆªé™¤æ•¸æ“š
        connector.delete_data('users', 'name = "John Doe"')
        
        # æŸ¥è©¢åˆªé™¤å¾Œçš„æ•¸æ“š
        results = connector.select_data('users')
        print("Users after deletion:", results)
    
    finally:
        # é—œé–‰é€£æ¥
        connector.close()

if __name__ == '__main__':
    main()
```

### 2. æ•¸æ“šåº«ç®¡ç†å™¨

```python
import sqlite3
import time
from typing import List, Dict, Any, Optional
import sys
import os

class DatabaseManager:
    def __init__(self, db_path: str):
        """åˆå§‹åŒ–æ•¸æ“šåº«ç®¡ç†å™¨"""
        self.db_path = db_path
        self.conn: Optional[sqlite3.Connection] = None
        self.cursor: Optional[sqlite3.Cursor] = None
        self.tables: Dict[str, List[str]] = {}
    
    def connect(self):
        """é€£æ¥åˆ°æ•¸æ“šåº«"""
        try:
            # å»ºç«‹é€£æ¥
            self.conn = sqlite3.connect(self.db_path)
            self.cursor = self.conn.cursor()
            print(f"Connected to database: {self.db_path}")
            
            # ç²å–è¡¨çµæ§‹
            self._load_tables()
            
        except Exception as e:
            print(f"Error connecting to database: {e}")
            self.close()
    
    def close(self):
        """é—œé–‰æ•¸æ“šåº«é€£æ¥"""
        if self.cursor:
            self.cursor.close()
        if self.conn:
            self.conn.close()
        print("Database connection closed")
    
    def _load_tables(self):
        """åŠ è¼‰è¡¨çµæ§‹"""
        try:
            # ç²å–æ‰€æœ‰è¡¨å
            self.cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
            tables = self.cursor.fetchall()
            
            # ç²å–æ¯å€‹è¡¨çš„åˆ—ä¿¡æ¯
            for table in tables:
                table_name = table[0]
                self.cursor.execute(f"PRAGMA table_info({table_name})")
                columns = [col[1] for col in self.cursor.fetchall()]
                self.tables[table_name] = columns
            
            print("Tables loaded:", self.tables)
            
        except Exception as e:
            print(f"Error loading tables: {e}")
    
    def create_table(self, table_name: str, columns: List[str]):
        """å‰µå»ºæ•¸æ“šè¡¨"""
        try:
            # æ§‹å»ºCREATE TABLEèªå¥
            query = f"CREATE TABLE IF NOT EXISTS {table_name} ({', '.join(columns)})"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.cursor.execute(query)
            self.conn.commit()
            
            # æ›´æ–°è¡¨çµæ§‹
            self._load_tables()
            print(f"Table {table_name} created successfully")
            
        except Exception as e:
            print(f"Error creating table: {e}")
            self.conn.rollback()
    
    def insert_data(self, table_name: str, data: Dict[str, Any]):
        """æ’å…¥æ•¸æ“š"""
        try:
            # æª¢æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
            if table_name not in self.tables:
                raise ValueError(f"Table {table_name} does not exist")
            
            # æª¢æŸ¥åˆ—æ˜¯å¦å­˜åœ¨
            for col in data.keys():
                if col not in self.tables[table_name]:
                    raise ValueError(f"Column {col} does not exist in table {table_name}")
            
            # æ§‹å»ºINSERTèªå¥
            columns = ', '.join(data.keys())
            placeholders = ', '.join(['?' for _ in data])
            query = f"INSERT INTO {table_name} ({columns}) VALUES ({placeholders})"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.cursor.execute(query, tuple(data.values()))
            self.conn.commit()
            print(f"Data inserted into {table_name}")
            
        except Exception as e:
            print(f"Error inserting data: {e}")
            self.conn.rollback()
    
    def select_data(self, table_name: str, columns: List[str] = None, where: str = None):
        """æŸ¥è©¢æ•¸æ“š"""
        try:
            # æª¢æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
            if table_name not in self.tables:
                raise ValueError(f"Table {table_name} does not exist")
            
            # æª¢æŸ¥åˆ—æ˜¯å¦å­˜åœ¨
            if columns:
                for col in columns:
                    if col not in self.tables[table_name]:
                        raise ValueError(f"Column {col} does not exist in table {table_name}")
            
            # æ§‹å»ºSELECTèªå¥
            cols = '*' if not columns else ', '.join(columns)
            query = f"SELECT {cols} FROM {table_name}"
            
            if where:
                query += f" WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.cursor.execute(query)
            return self.cursor.fetchall()
            
        except Exception as e:
            print(f"Error selecting data: {e}")
            return []
    
    def update_data(self, table_name: str, data: Dict[str, Any], where: str):
        """æ›´æ–°æ•¸æ“š"""
        try:
            # æª¢æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
            if table_name not in self.tables:
                raise ValueError(f"Table {table_name} does not exist")
            
            # æª¢æŸ¥åˆ—æ˜¯å¦å­˜åœ¨
            for col in data.keys():
                if col not in self.tables[table_name]:
                    raise ValueError(f"Column {col} does not exist in table {table_name}")
            
            # æ§‹å»ºUPDATEèªå¥
            set_clause = ', '.join([f"{k} = ?" for k in data.keys()])
            query = f"UPDATE {table_name} SET {set_clause} WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.cursor.execute(query, tuple(data.values()))
            self.conn.commit()
            print(f"Data updated in {table_name}")
            
        except Exception as e:
            print(f"Error updating data: {e}")
            self.conn.rollback()
    
    def delete_data(self, table_name: str, where: str):
        """åˆªé™¤æ•¸æ“š"""
        try:
            # æª¢æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
            if table_name not in self.tables:
                raise ValueError(f"Table {table_name} does not exist")
            
            # æ§‹å»ºDELETEèªå¥
            query = f"DELETE FROM {table_name} WHERE {where}"
            
            # åŸ·è¡ŒæŸ¥è©¢
            self.cursor.execute(query)
            self.conn.commit()
            print(f"Data deleted from {table_name}")
            
        except Exception as e:
            print(f"Error deleting data: {e}")
            self.conn.rollback()

# ä½¿ç”¨ç¤ºä¾‹
def main():
    # å‰µå»ºæ•¸æ“šåº«ç®¡ç†å™¨
    manager = DatabaseManager('test.db')
    
    try:
        # é€£æ¥åˆ°æ•¸æ“šåº«
        manager.connect()
        
        # å‰µå»ºç”¨æˆ¶è¡¨
        manager.create_table('users', [
            'id INTEGER PRIMARY KEY AUTOINCREMENT',
            'name TEXT NOT NULL',
            'email TEXT UNIQUE',
            'age INTEGER'
        ])
        
        # æ’å…¥æ•¸æ“š
        manager.insert_data('users', {
            'name': 'John Doe',
            'email': 'john@example.com',
            'age': 30
        })
        
        # æŸ¥è©¢æ•¸æ“š
        results = manager.select_data('users')
        print("Users:", results)
        
        # æ›´æ–°æ•¸æ“š
        manager.update_data('users', {'age': 31}, 'name = "John Doe"')
        
        # æŸ¥è©¢æ›´æ–°å¾Œçš„æ•¸æ“š
        results = manager.select_data('users')
        print("Updated users:", results)
        
        # åˆªé™¤æ•¸æ“š
        manager.delete_data('users', 'name = "John Doe"')
        
        # æŸ¥è©¢åˆªé™¤å¾Œçš„æ•¸æ“š
        results = manager.select_data('users')
        print("Users after deletion:", results)
    
    finally:
        # é—œé–‰é€£æ¥
        manager.close()

if __name__ == '__main__':
    main()
```

## ç·´ç¿’é¡Œ

1. **æ•¸æ“šåº«é€£æ¥å™¨**
   é–‹ç™¼ä¸€å€‹æ•¸æ“šåº«é€£æ¥å™¨ï¼š
   - æ”¯æŒæ•¸æ“šåº«é€£æ¥
   - è™•ç†SQLæŸ¥è©¢
   - å„ªåŒ–è³‡æºä½¿ç”¨
   - æä¾›éŒ¯èª¤è™•ç†

2. **æ•¸æ“šåº«ç®¡ç†å™¨**
   å‰µå»ºä¸€å€‹æ•¸æ“šåº«ç®¡ç†å™¨ï¼š
   - ç®¡ç†æ•¸æ“šè¡¨çµæ§‹
   - è™•ç†æ•¸æ“šæ“ä½œ
   - å„ªåŒ–æŸ¥è©¢æ•ˆç‡
   - æä¾›äº‹å‹™æ”¯æŒ

3. **æ•¸æ“šåº«æ‡‰ç”¨**
   å¯¦ç¾ä¸€å€‹æ•¸æ“šåº«æ‡‰ç”¨ï¼š
   - è¨­è¨ˆæ•¸æ“šæ¨¡å‹
   - å¯¦ç¾CRUDæ“ä½œ
   - å„ªåŒ–æ€§èƒ½
   - è™•ç†è¤‡é›œæŸ¥è©¢

## å°æé†’ ğŸ’¡

1. æ•¸æ“šåº«è¨­è¨ˆ
   - é¸æ“‡åˆé©æ¨¡å‹
   - è¨­è¨ˆè¡¨çµæ§‹
   - å„ªåŒ–ç´¢å¼•
   - è€ƒæ…®æ“´å±•æ€§

2. æ•¸æ“šæ“ä½œ
   - ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢
   - è™•ç†äº‹å‹™
   - å„ªåŒ–æŸ¥è©¢
   - è™•ç†ç•°å¸¸

3. æ€§èƒ½å„ªåŒ–
   - æ¸›å°‘æŸ¥è©¢æ¬¡æ•¸
   - å„ªåŒ–ç´¢å¼•
   - ä½¿ç”¨é€£æ¥æ± 
   - ç›£æ§æ€§èƒ½

4. èª¿è©¦æŠ€å·§
   - ä½¿ç”¨SQLå·¥å…·
   - åˆ†ææŸ¥è©¢è¨ˆåŠƒ
   - å„ªåŒ–é—œéµè·¯å¾‘
   - ç›£æ§æ•¸æ“šåº«ç‹€æ…‹

[ä¸Šä¸€ç« ï¼šç¶²çµ¡ç·¨ç¨‹é€²éš](087_ç¶²çµ¡ç·¨ç¨‹é€²éš.md) | [ä¸‹ä¸€ç« ï¼šæ•¸æ“šåº«ç·¨ç¨‹é€²éš](089_æ•¸æ“šåº«ç·¨ç¨‹é€²éš.md) 