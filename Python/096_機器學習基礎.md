[ä¸Šä¸€ç« ï¼šæ•¸æ“šåˆ†æé€²éš](095_æ•¸æ“šåˆ†æé€²éš.md) | [ä¸‹ä¸€ç« ï¼šæ©Ÿå™¨å­¸ç¿’é€²éš](097_æ©Ÿå™¨å­¸ç¿’é€²éš.md)

# Python æ©Ÿå™¨å­¸ç¿’åŸºç¤ ğŸ¤–

## Scikit-learnåŸºç¤

### 1. æ•¸æ“šé è™•ç†

```python
import numpy as np
import pandas as pd
from sklearn.preprocessing import StandardScaler, LabelEncoder
from sklearn.model_selection import train_test_split
import time
from typing import List, Dict, Any, Optional, Tuple
import sys
import os

class DataPreprocessing:
    def __init__(self):
        """åˆå§‹åŒ–æ•¸æ“šé è™•ç†"""
        self.X = None
        self.y = None
        self.scaler = StandardScaler()
        self.label_encoder = LabelEncoder()
    
    def load_data(self, X: np.ndarray, y: np.ndarray):
        """åŠ è¼‰æ•¸æ“š"""
        try:
            self.X = X
            self.y = y
            print(f"Data loaded: X shape {X.shape}, y shape {y.shape}")
            return True
            
        except Exception as e:
            print(f"Error loading data: {e}")
            return False
    
    def scale_features(self) -> np.ndarray:
        """ç‰¹å¾µç¸®æ”¾"""
        if self.X is None:
            print("No data loaded")
            return None
        
        try:
            # æ¨™æº–åŒ–ç‰¹å¾µ
            X_scaled = self.scaler.fit_transform(self.X)
            print("Features scaled")
            return X_scaled
            
        except Exception as e:
            print(f"Error scaling features: {e}")
            return None
    
    def encode_labels(self) -> np.ndarray:
        """æ¨™ç±¤ç·¨ç¢¼"""
        if self.y is None:
            print("No data loaded")
            return None
        
        try:
            # ç·¨ç¢¼æ¨™ç±¤
            y_encoded = self.label_encoder.fit_transform(self.y)
            print("Labels encoded")
            return y_encoded
            
        except Exception as e:
            print(f"Error encoding labels: {e}")
            return None
    
    def split_data(self, test_size: float = 0.2) -> Tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]:
        """åˆ†å‰²æ•¸æ“š"""
        if self.X is None or self.y is None:
            print("No data loaded")
            return None
        
        try:
            # åˆ†å‰²è¨“ç·´é›†å’Œæ¸¬è©¦é›†
            X_train, X_test, y_train, y_test = train_test_split(
                self.X, self.y,
                test_size=test_size,
                random_state=42
            )
            print(f"Data split: train {X_train.shape}, test {X_test.shape}")
            return X_train, X_test, y_train, y_test
            
        except Exception as e:
            print(f"Error splitting data: {e}")
            return None

# ä½¿ç”¨ç¤ºä¾‹
def main():
    # å‰µå»ºæ•¸æ“šé è™•ç†å™¨
    preprocessor = DataPreprocessing()
    
    try:
        # å‰µå»ºç¤ºä¾‹æ•¸æ“š
        X = np.random.rand(100, 5)  # 100å€‹æ¨£æœ¬ï¼Œ5å€‹ç‰¹å¾µ
        y = np.random.randint(0, 3, 100)  # 3å€‹é¡åˆ¥
        
        # åŠ è¼‰æ•¸æ“š
        preprocessor.load_data(X, y)
        
        # ç¸®æ”¾ç‰¹å¾µ
        X_scaled = preprocessor.scale_features()
        
        # ç·¨ç¢¼æ¨™ç±¤
        y_encoded = preprocessor.encode_labels()
        
        # åˆ†å‰²æ•¸æ“š
        X_train, X_test, y_train, y_test = preprocessor.split_data()
    
    except Exception as e:
        print(f"Error in main: {e}")

if __name__ == '__main__':
    main()
```

### 2. æ¨¡å‹è¨“ç·´

```python
import numpy as np
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, classification_report
import time
from typing import List, Dict, Any, Optional, Tuple
import sys
import os

class ModelTraining:
    def __init__(self):
        """åˆå§‹åŒ–æ¨¡å‹è¨“ç·´"""
        self.models = {
            'logistic': LogisticRegression(),
            'decision_tree': DecisionTreeClassifier(),
            'random_forest': RandomForestClassifier()
        }
        self.best_model = None
        self.best_score = 0
    
    def train_model(self, model_name: str, X_train: np.ndarray, y_train: np.ndarray):
        """è¨“ç·´æ¨¡å‹"""
        if model_name not in self.models:
            print(f"Model {model_name} not found")
            return None
        
        try:
            # ç²å–æ¨¡å‹
            model = self.models[model_name]
            
            # è¨“ç·´æ¨¡å‹
            start_time = time.time()
            model.fit(X_train, y_train)
            training_time = time.time() - start_time
            
            print(f"Model {model_name} trained in {training_time:.2f} seconds")
            return model
            
        except Exception as e:
            print(f"Error training model: {e}")
            return None
    
    def evaluate_model(self, model: Any, X_test: np.ndarray, y_test: np.ndarray):
        """è©•ä¼°æ¨¡å‹"""
        if model is None:
            print("No model provided")
            return None
        
        try:
            # é æ¸¬
            y_pred = model.predict(X_test)
            
            # è¨ˆç®—æº–ç¢ºç‡
            accuracy = accuracy_score(y_test, y_pred)
            
            # ç”Ÿæˆåˆ†é¡å ±å‘Š
            report = classification_report(y_test, y_pred)
            
            print(f"Accuracy: {accuracy:.4f}")
            print("Classification Report:")
            print(report)
            
            return accuracy, report
            
        except Exception as e:
            print(f"Error evaluating model: {e}")
            return None
    
    def select_best_model(self, X_train: np.ndarray, y_train: np.ndarray, X_test: np.ndarray, y_test: np.ndarray):
        """é¸æ“‡æœ€ä½³æ¨¡å‹"""
        try:
            # è¨“ç·´å’Œè©•ä¼°æ‰€æœ‰æ¨¡å‹
            for model_name, model in self.models.items():
                # è¨“ç·´æ¨¡å‹
                trained_model = self.train_model(model_name, X_train, y_train)
                if trained_model is None:
                    continue
                
                # è©•ä¼°æ¨¡å‹
                accuracy, _ = self.evaluate_model(trained_model, X_test, y_test)
                if accuracy is None:
                    continue
                
                # æ›´æ–°æœ€ä½³æ¨¡å‹
                if accuracy > self.best_score:
                    self.best_score = accuracy
                    self.best_model = trained_model
                    print(f"New best model: {model_name} with accuracy {accuracy:.4f}")
            
            return self.best_model, self.best_score
            
        except Exception as e:
            print(f"Error selecting best model: {e}")
            return None, 0

# ä½¿ç”¨ç¤ºä¾‹
def main():
    # å‰µå»ºæ¨¡å‹è¨“ç·´å™¨
    trainer = ModelTraining()
    
    try:
        # å‰µå»ºç¤ºä¾‹æ•¸æ“š
        X_train = np.random.rand(80, 5)  # 80å€‹è¨“ç·´æ¨£æœ¬
        y_train = np.random.randint(0, 3, 80)
        X_test = np.random.rand(20, 5)   # 20å€‹æ¸¬è©¦æ¨£æœ¬
        y_test = np.random.randint(0, 3, 20)
        
        # é¸æ“‡æœ€ä½³æ¨¡å‹
        best_model, best_score = trainer.select_best_model(
            X_train, y_train, X_test, y_test
        )
        
        if best_model is not None:
            print(f"Best model selected with accuracy {best_score:.4f}")
    
    except Exception as e:
        print(f"Error in main: {e}")

if __name__ == '__main__':
    main()
```

## ç·´ç¿’é¡Œ

1. **æ•¸æ“šé è™•ç†**
   é–‹ç™¼æ•¸æ“šé è™•ç†ï¼š
   - åŠ è¼‰æ•¸æ“š
   - ç¸®æ”¾ç‰¹å¾µ
   - ç·¨ç¢¼æ¨™ç±¤
   - åˆ†å‰²æ•¸æ“š

2. **æ¨¡å‹è¨“ç·´**
   å‰µå»ºæ¨¡å‹è¨“ç·´ï¼š
   - è¨“ç·´æ¨¡å‹
   - è©•ä¼°æ¨¡å‹
   - é¸æ“‡æ¨¡å‹
   - å„ªåŒ–æ€§èƒ½

3. **æ©Ÿå™¨å­¸ç¿’**
   å¯¦ç¾æ©Ÿå™¨å­¸ç¿’ï¼š
   - è™•ç†æ•¸æ“š
   - è¨“ç·´æ¨¡å‹
   - å„ªåŒ–æ€§èƒ½
   - è™•ç†ç•°å¸¸

## å°æé†’ ğŸ’¡

1. æ•¸æ“šé è™•ç†
   - é¸æ“‡åˆé©æ–¹æ³•
   - å„ªåŒ–æ€§èƒ½
   - è™•ç†ç•°å¸¸
   - æä¾›ç›£æ§

2. æ¨¡å‹è¨“ç·´
   - é¸æ“‡åˆé©æ¨¡å‹
   - å„ªåŒ–åƒæ•¸
   - è™•ç†ç•°å¸¸
   - æä¾›çµæœ

3. æ©Ÿå™¨å­¸ç¿’
   - é¸æ“‡åˆé©ç®—æ³•
   - å„ªåŒ–æ€§èƒ½
   - è™•ç†ç•°å¸¸
   - æä¾›ç›£æ§

4. èª¿è©¦æŠ€å·§
   - ä½¿ç”¨é–‹ç™¼å·¥å…·
   - åˆ†ææ€§èƒ½
   - å„ªåŒ–é—œéµè·¯å¾‘
   - ç›£æ§è¨“ç·´ç‹€æ…‹

[ä¸Šä¸€ç« ï¼šæ•¸æ“šåˆ†æé€²éš](095_æ•¸æ“šåˆ†æé€²éš.md) | [ä¸‹ä¸€ç« ï¼šæ©Ÿå™¨å­¸ç¿’é€²éš](097_æ©Ÿå™¨å­¸ç¿’é€²éš.md) 