[ä¸Šä¸€ç« ï¼šæ­£å‰‡è¡¨é”å¼åŸºç¤](035_æ­£å‰‡è¡¨é”å¼åŸºç¤.md) | [ä¸‹ä¸€ç« ï¼šæ—¥æœŸèˆ‡æ™‚é–“è™•ç†](037_æ—¥æœŸèˆ‡æ™‚é–“è™•ç†.md)

# Python æ­£å‰‡è¡¨é”å¼é€²éš ğŸ¯

## é€²éšåŒ¹é…æŠ€å·§

### 1. å‰å‘æ–·è¨€èˆ‡å¾Œå‘æ–·è¨€

```python
import re

# æ­£å‘å‰å‘æ–·è¨€ (?=...)
text = "John Doe, Jane Doe"
pattern = r"\w+(?=\sDoe)"  # åŒ¹é…å¾Œé¢æ¥è‘— Doe çš„å–®è©
result = re.findall(pattern, text)
print(result)  # è¼¸å‡º: ['John', 'Jane']

# è² å‘å‰å‘æ–·è¨€ (?!...)
pattern = r"\w+(?!\sDoe)"  # åŒ¹é…å¾Œé¢ä¸æ˜¯ Doe çš„å–®è©
result = re.findall(pattern, text)
print(result)  # è¼¸å‡º: ['Doe', 'Doe']

# æ­£å‘å¾Œå‘æ–·è¨€ (?<=...)
text = "$100 and â‚¬200"
pattern = r"(?<=\$)\d+"  # åŒ¹é…å‰é¢æ˜¯ $ çš„æ•¸å­—
result = re.findall(pattern, text)
print(result)  # è¼¸å‡º: ['100']

# è² å‘å¾Œå‘æ–·è¨€ (?<!...)
pattern = r"(?<!\$)\d+"  # åŒ¹é…å‰é¢ä¸æ˜¯ $ çš„æ•¸å­—
result = re.findall(pattern, text)
print(result)  # è¼¸å‡º: ['200']
```

### 2. æ¢ä»¶åŒ¹é…

```python
# (?(id/name)yes-pattern|no-pattern)
def match_tag(text):
    pattern = r'<(/)?([a-z]+)(?(1)>|(\s+[^>]*>))'
    return re.match(pattern, text)

# æ¸¬è©¦
print(bool(match_tag("<tag>")))        # True
print(bool(match_tag("</tag>")))       # True
print(bool(match_tag("<tag attr>")))   # True
print(bool(match_tag("</tag attr>")))  # False
```

## æ­£å‰‡è¡¨é”å¼æœ€ä½³åŒ–

### 1. ä½¿ç”¨ re.compile()

```python
# ç·¨è­¯æ­£å‰‡è¡¨é”å¼
email_pattern = re.compile(r'^[\w\.-]+@[\w\.-]+\.\w+$')

# å¤šæ¬¡ä½¿ç”¨
emails = [
    "user@example.com",
    "invalid.email",
    "user.name@company.co.uk"
]

for email in emails:
    if email_pattern.match(email):
        print(f"{email} is valid")
    else:
        print(f"{email} is invalid")
```

### 2. éæ•ç²åˆ†çµ„

```python
# ä½¿ç”¨ (?:...) é€²è¡Œéæ•ç²åˆ†çµ„
text = "2023-01-01 and 2023/01/01"

# ä½¿ç”¨æ•ç²åˆ†çµ„
pattern1 = r'(\d{4})[-/](\d{2})[-/](\d{2})'
matches1 = re.findall(pattern1, text)
print(matches1)  # è¼¸å‡º: [('2023', '01', '01'), ('2023', '01', '01')]

# ä½¿ç”¨éæ•ç²åˆ†çµ„
pattern2 = r'\d{4}(?:[-/])\d{2}(?:[-/])\d{2}'
matches2 = re.findall(pattern2, text)
print(matches2)  # è¼¸å‡º: ['2023-01-01', '2023/01/01']
```

## è¤‡é›œæ¨¡å¼åŒ¹é…

### 1. éè¿´æ¨¡å¼

```python
def match_nested_parentheses(text):
    pattern = r'\((?>[^()]+|\((?<depth>)|\)(?<-depth>))*(?(depth)(?!))\)'
    return bool(re.match(pattern, text))

# æ¸¬è©¦
print(match_nested_parentheses("(())"))      # True
print(match_nested_parentheses("((())"))     # False
print(match_nested_parentheses("(()())"))    # True
```

### 2. å¹³è¡¡çµ„

```python
def match_html(text):
    pattern = r'''
        <(?P<tag>[a-z]+)>    # é–‹å§‹æ¨™ç±¤
        .*?                   # å…§å®¹ï¼ˆéè²ªå©ªï¼‰
        </(?P=tag)>          # çµæŸæ¨™ç±¤
    '''
    return re.match(pattern, text, re.VERBOSE)

# æ¸¬è©¦
print(bool(match_html("<div>content</div>")))     # True
print(bool(match_html("<div>content</span>")))    # False
```

## æ­£å‰‡è¡¨é”å¼æ¨™èªŒ

### 1. å¸¸ç”¨æ¨™èªŒ

```python
# re.IGNORECASE (re.I)
pattern = re.compile(r'python', re.IGNORECASE)
print(pattern.findall("Python PYTHON python"))  # ['Python', 'PYTHON', 'python']

# re.MULTILINE (re.M)
text = """First line
Second line
Third line"""
pattern = re.compile(r'^.+$', re.MULTILINE)
print(pattern.findall(text))  # ['First line', 'Second line', 'Third line']

# re.VERBOSE (re.X)
pattern = re.compile(r'''
    \d{4}  # å¹´
    [-/]   # åˆ†éš”ç¬¦
    \d{2}  # æœˆ
    [-/]   # åˆ†éš”ç¬¦
    \d{2}  # æ—¥
    ''', re.VERBOSE)
```

### 2. çµ„åˆæ¨™èªŒ

```python
# çµ„åˆå¤šå€‹æ¨™èªŒ
pattern = re.compile(r'''
    [a-z]+      # å­—æ¯
    \s+         # ç©ºç™½
    \d+         # æ•¸å­—
    ''', re.VERBOSE | re.IGNORECASE)

text = "Test 123\nTEST 456"
print(pattern.findall(text))  # ['Test 123', 'TEST 456']
```

## æ•ˆèƒ½å„ªåŒ–æŠ€å·§

### 1. é¿å…å›æº¯

```python
# ä¸å¥½çš„æ¨¡å¼ï¼ˆå¯èƒ½å°è‡´ç½é›£æ€§å›æº¯ï¼‰
bad_pattern = r'<.*>'

# å¥½çš„æ¨¡å¼
good_pattern = r'<[^>]*>'

text = "<tag>some content</tag>"
print(re.findall(good_pattern, text))
```

### 2. ä½¿ç”¨åŸå­åˆ†çµ„

```python
# ä½¿ç”¨åŸå­åˆ†çµ„ (?>...)
text = "aaaaa"

# æ™®é€šåˆ†çµ„
pattern1 = r'(a+)a'
match1 = re.match(pattern1, text)
print(match1.group(1))  # 'aaaa'

# åŸå­åˆ†çµ„
pattern2 = r'(?>a+)a'
match2 = re.match(pattern2, text)
print(match2)  # Noneï¼ˆå› ç‚ºåŸå­åˆ†çµ„ä¸å…è¨±å›æº¯ï¼‰
```

## å¯¦éš›æ‡‰ç”¨ç¯„ä¾‹

### 1. ç¨‹å¼ç¢¼åˆ†æå™¨

```python
def analyze_python_code(code):
    patterns = {
        'functions': r'def\s+(\w+)\s*\([^)]*\):',
        'classes': r'class\s+(\w+)(?:\([^)]*\))?:',
        'imports': r'(?:from\s+[\w.]+\s+)?import\s+[\w.,\s]+',
        'comments': r'#.*$'
    }
    
    results = {}
    for name, pattern in patterns.items():
        results[name] = re.findall(pattern, code, re.MULTILINE)
    
    return results

# æ¸¬è©¦
code = """
# This is a comment
import os
from datetime import datetime

class MyClass:
    def __init__(self):
        pass
        
def my_function():
    return True
"""

analysis = analyze_python_code(code)
for key, value in analysis.items():
    print(f"{key}: {value}")
```

### 2. æ—¥èªŒè§£æå™¨

```python
def parse_log_line(line):
    pattern = r'''
        (?P<timestamp>\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})\s+
        (?P<level>INFO|WARNING|ERROR)\s+
        (?P<message>.+)
    '''
    match = re.match(pattern, line, re.VERBOSE)
    if match:
        return match.groupdict()
    return None

# æ¸¬è©¦
log_line = "2023-05-20 10:15:30 ERROR Database connection failed"
result = parse_log_line(log_line)
print(result)
```

## ç·´ç¿’é¡Œ

1. **HTML è§£æå™¨**
   å¯¦ç¾ä¸€å€‹ç°¡å–®çš„ HTML è§£æå™¨ï¼š
   - æå–æ‰€æœ‰æ¨™ç±¤
   - è§£ææ¨™ç±¤å±¬æ€§
   - æå–æ–‡æœ¬å…§å®¹
   - è™•ç†åµŒå¥—çµæ§‹

2. **ç¨‹å¼ç¢¼é‡æ§‹å·¥å…·**
   é–‹ç™¼ä¸€å€‹ç¨‹å¼ç¢¼é‡æ§‹å·¥å…·ï¼š
   - é‡å‘½åè®Šæ•¸/å‡½æ•¸
   - æå–å¸¸é‡
   - æ ¼å¼åŒ–è¨»é‡‹
   - æª¢æ¸¬ä»£ç¢¼é¢¨æ ¼

3. **é…ç½®æª”æ¡ˆè§£æå™¨**
   å‰µå»ºä¸€å€‹é…ç½®æª”æ¡ˆè§£æå™¨ï¼š
   - æ”¯æ´å¤šç¨®æ ¼å¼
   - è™•ç†è¨»é‡‹
   - é©—è­‰èªæ³•
   - è½‰æ›æ ¼å¼

## å°æé†’ ğŸ’¡

1. ä½¿ç”¨å‘½ååˆ†çµ„æé«˜å¯è®€æ€§
2. é©ç•¶ä½¿ç”¨éæ•ç²åˆ†çµ„æå‡æ•ˆèƒ½
3. æ³¨æ„å›æº¯å•é¡Œ
4. ä½¿ç”¨ VERBOSE æ¨¡å¼æé«˜å¯ç¶­è­·æ€§
5. å–„ç”¨æ–·è¨€å„ªåŒ–åŒ¹é…
6. è€ƒæ…®ä½¿ç”¨åŸå­åˆ†çµ„é¿å…å›æº¯

[ä¸Šä¸€ç« ï¼šæ­£å‰‡è¡¨é”å¼åŸºç¤](035_æ­£å‰‡è¡¨é”å¼åŸºç¤.md) | [ä¸‹ä¸€ç« ï¼šæ—¥æœŸèˆ‡æ™‚é–“è™•ç†](037_æ—¥æœŸèˆ‡æ™‚é–“è™•ç†.md) 