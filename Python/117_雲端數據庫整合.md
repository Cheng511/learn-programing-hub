[ä¸Šä¸€ç« ï¼šåˆ†å¸ƒå¼è¨ˆç®—](116_åˆ†å¸ƒå¼è¨ˆç®—.md) | [ä¸‹ä¸€ç« ï¼šæ©Ÿå™¨å­¸ç¿’éƒ¨ç½²](118_æ©Ÿå™¨å­¸ç¿’éƒ¨ç½².md)

# Python é›²ç«¯æ•¸æ“šåº«æ•´åˆ â˜ï¸

## 1. AWS æ•¸æ“šåº«æœå‹™

### 1.1 Amazon RDS æ•´åˆ

```python
import boto3
import pymysql
from typing import Dict, List, Any
from contextlib import contextmanager

class RDSManager:
    def __init__(self, config: Dict):
        self.config = config
        self.client = boto3.client('rds')
    
    @contextmanager
    def get_connection(self):
        """ç²å–æ•¸æ“šåº«é€£æ¥"""
        conn = pymysql.connect(
            host=self.config['host'],
            user=self.config['user'],
            password=self.config['password'],
            db=self.config['database']
        )
        try:
            yield conn
        finally:
            conn.close()
    
    def execute_query(self, query: str, params: tuple = None) -> List[Dict]:
        """åŸ·è¡ŒæŸ¥è©¢"""
        with self.get_connection() as conn:
            with conn.cursor(pymysql.cursors.DictCursor) as cursor:
                cursor.execute(query, params or ())
                return cursor.fetchall()
```

### 1.2 DynamoDB æ‡‰ç”¨

```python
import boto3
from boto3.dynamodb.conditions import Key, Attr
from typing import Dict, List, Any

class DynamoDBManager:
    def __init__(self, table_name: str, region: str = 'us-west-2'):
        self.dynamodb = boto3.resource('dynamodb', region_name=region)
        self.table = self.dynamodb.Table(table_name)
    
    def put_item(self, item: Dict):
        """æ·»åŠ é …ç›®"""
        return self.table.put_item(Item=item)
    
    def get_item(self, key: Dict) -> Dict:
        """ç²å–é …ç›®"""
        response = self.table.get_item(Key=key)
        return response.get('Item')
    
    def query_items(self, key_condition: Dict) -> List[Dict]:
        """æŸ¥è©¢é …ç›®"""
        response = self.table.query(
            KeyConditionExpression=Key(key_condition['key']).eq(key_condition['value'])
        )
        return response['Items']
```

## 2. Google Cloud Platform æ•´åˆ

### 2.1 Cloud SQL é€£æ¥

```python
from google.cloud import sql
from google.cloud.sql.connector import Connector
import sqlalchemy

class CloudSQLManager:
    def __init__(self, connection_name: str, db_user: str, db_pass: str, db_name: str):
        self.connection_name = connection_name
        self.db_user = db_user
        self.db_pass = db_pass
        self.db_name = db_name
        self.connector = Connector()
    
    def get_connection(self):
        """ç²å–Cloud SQLé€£æ¥"""
        return self.connector.connect(
            self.connection_name,
            "pymysql",
            user=self.db_user,
            password=self.db_pass,
            db=self.db_name,
        )
    
    def create_engine(self):
        """å‰µå»ºSQLAlchemyå¼•æ“"""
        return sqlalchemy.create_engine(
            "mysql+pymysql://",
            creator=self.get_connection
        )
```

### 2.2 Firestore æ‡‰ç”¨

```python
from google.cloud import firestore
from typing import Dict, List, Optional

class FirestoreManager:
    def __init__(self):
        self.db = firestore.Client()
    
    def add_document(self, collection: str, data: Dict, doc_id: Optional[str] = None):
        """æ·»åŠ æ–‡æª”"""
        if doc_id:
            return self.db.collection(collection).document(doc_id).set(data)
        return self.db.collection(collection).add(data)
    
    def get_document(self, collection: str, doc_id: str) -> Dict:
        """ç²å–æ–‡æª”"""
        doc_ref = self.db.collection(collection).document(doc_id)
        doc = doc_ref.get()
        return doc.to_dict() if doc.exists else None
    
    def query_documents(self, collection: str, filters: List[tuple]) -> List[Dict]:
        """æŸ¥è©¢æ–‡æª”"""
        query = self.db.collection(collection)
        for field, op, value in filters:
            query = query.where(field, op, value)
        return [doc.to_dict() for doc in query.stream()]
```

## 3. Azure æ•¸æ“šåº«æœå‹™

### 3.1 Azure SQL Database

```python
import pyodbc
from typing import Dict, List
import urllib.parse

class AzureSQLManager:
    def __init__(self, server: str, database: str, username: str, password: str):
        self.connection_string = (
            f"Driver={{ODBC Driver 17 for SQL Server}};"
            f"Server={server};"
            f"Database={database};"
            f"Uid={username};"
            f"Pwd={password};"
            "Encrypt=yes;"
            "TrustServerCertificate=no;"
            "Connection Timeout=30;"
        )
    
    def execute_query(self, query: str, params: tuple = None) -> List[Dict]:
        """åŸ·è¡ŒæŸ¥è©¢"""
        with pyodbc.connect(self.connection_string) as conn:
            cursor = conn.cursor()
            cursor.execute(query, params or ())
            columns = [column[0] for column in cursor.description]
            return [dict(zip(columns, row)) for row in cursor.fetchall()]
```

### 3.2 Cosmos DB æ‡‰ç”¨

```python
from azure.cosmos import CosmosClient, PartitionKey
from typing import Dict, List

class CosmosDBManager:
    def __init__(self, endpoint: str, key: str, database_name: str):
        self.client = CosmosClient(endpoint, key)
        self.database = self.client.get_database_client(database_name)
    
    def create_container(self, container_name: str, partition_key: str):
        """å‰µå»ºå®¹å™¨"""
        return self.database.create_container_if_not_exists(
            id=container_name,
            partition_key=PartitionKey(path=f"/{partition_key}")
        )
    
    def add_item(self, container_name: str, item: Dict):
        """æ·»åŠ é …ç›®"""
        container = self.database.get_container_client(container_name)
        return container.create_item(body=item)
    
    def query_items(self, container_name: str, query: str, params: List = None) -> List[Dict]:
        """æŸ¥è©¢é …ç›®"""
        container = self.database.get_container_client(container_name)
        return list(container.query_items(
            query=query,
            parameters=params,
            enable_cross_partition_query=True
        ))
```

## 4. å¤šé›²ç«¯æ•´åˆ

### 4.1 çµ±ä¸€æ¥å£è¨­è¨ˆ

```python
from abc import ABC, abstractmethod
from typing import Dict, List, Any

class CloudDatabaseInterface(ABC):
    @abstractmethod
    def connect(self):
        """é€£æ¥åˆ°æ•¸æ“šåº«"""
        pass
    
    @abstractmethod
    def execute_query(self, query: str, params: Any = None):
        """åŸ·è¡ŒæŸ¥è©¢"""
        pass
    
    @abstractmethod
    def close(self):
        """é—œé–‰é€£æ¥"""
        pass

class MultiCloudManager:
    def __init__(self):
        self.connections: Dict[str, CloudDatabaseInterface] = {}
    
    def add_connection(self, name: str, connection: CloudDatabaseInterface):
        """æ·»åŠ é›²ç«¯æ•¸æ“šåº«é€£æ¥"""
        self.connections[name] = connection
    
    def execute_cross_cloud_query(self, queries: Dict[str, str]) -> Dict[str, List]:
        """åŸ·è¡Œè·¨é›²æŸ¥è©¢"""
        results = {}
        for cloud_name, query in queries.items():
            if cloud_name in self.connections:
                conn = self.connections[cloud_name]
                results[cloud_name] = conn.execute_query(query)
        return results
```

### 4.2 æ•¸æ“šåŒæ­¥ç­–ç•¥

```python
import asyncio
from typing import List, Dict, Callable
from datetime import datetime

class CloudSyncManager:
    def __init__(self):
        self.sync_tasks: List[Dict] = []
    
    def add_sync_task(self, source: CloudDatabaseInterface, 
                      target: CloudDatabaseInterface,
                      sync_function: Callable):
        """æ·»åŠ åŒæ­¥ä»»å‹™"""
        self.sync_tasks.append({
            'source': source,
            'target': target,
            'sync_function': sync_function,
            'last_sync': None
        })
    
    async def sync_all(self):
        """åŸ·è¡Œæ‰€æœ‰åŒæ­¥ä»»å‹™"""
        tasks = []
        for task in self.sync_tasks:
            tasks.append(self._sync_task(task))
        await asyncio.gather(*tasks)
    
    async def _sync_task(self, task: Dict):
        """åŸ·è¡Œå–®å€‹åŒæ­¥ä»»å‹™"""
        try:
            await task['sync_function'](task['source'], task['target'])
            task['last_sync'] = datetime.now()
        except Exception as e:
            print(f"Sync failed: {str(e)}")
```

## ç·´ç¿’é¡Œ ğŸƒ

1. å¯¦ç¾ä¸€å€‹AWS RDSå’ŒDynamoDBçš„æ•¸æ“šåŒæ­¥å·¥å…·ã€‚
2. é–‹ç™¼ä¸€å€‹è·¨é›²ç«¯æ•¸æ“šåº«çš„æŸ¥è©¢ä»‹é¢ã€‚
3. è¨­è¨ˆä¸€å€‹é›²ç«¯æ•¸æ“šåº«çš„å‚™ä»½å’Œæ¢å¾©ç³»çµ±ã€‚
4. å¯¦ç¾ä¸€å€‹å¤šé›²ç«¯æ•¸æ“šåº«çš„ç›£æ§å·¥å…·ã€‚
5. å‰µå»ºä¸€å€‹è‡ªå‹•åŒ–çš„é›²ç«¯æ•¸æ“šåº«é·ç§»å·¥å…·ã€‚

## å°çµ ğŸ“

- å­¸ç¿’äº†AWSæ•¸æ“šåº«æœå‹™çš„ä½¿ç”¨
- æŒæ¡äº†GCPæ•¸æ“šåº«æ•´åˆæ–¹æ³•
- ç†è§£äº†Azureæ•¸æ“šåº«æœå‹™çš„æ‡‰ç”¨
- å­¸æœƒäº†å¤šé›²ç«¯æ•¸æ“šåº«çš„æ•´åˆ
- äº†è§£äº†é›²ç«¯æ•¸æ“šåŒæ­¥ç­–ç•¥

## å»¶ä¼¸é–±è®€ ğŸ“š

1. AWS Database Services Guide
2. Google Cloud SQL Documentation
3. Azure Cosmos DB Best Practices
4. Multi-Cloud Database Management
5. Cloud Database Security Patterns

[ä¸Šä¸€ç« ï¼šåˆ†å¸ƒå¼è¨ˆç®—](116_åˆ†å¸ƒå¼è¨ˆç®—.md) | [ä¸‹ä¸€ç« ï¼šæ©Ÿå™¨å­¸ç¿’éƒ¨ç½²](118_æ©Ÿå™¨å­¸ç¿’éƒ¨ç½².md) 